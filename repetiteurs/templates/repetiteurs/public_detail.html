<!-- filepath: c:\Users\Bano\Documents\University\Soutenance\KaramokoSoutenance\repetiteurs\templates\repetiteurs\public_detail.html -->
{% extends "_base.html" %}
{% load static %}

{% block content %}
<section class="py-16 bg-gray-50">
    <div class="container mx-auto px-4">
        <!-- En-tête -->
        <div class="flex flex-col md:flex-row bg-white p-6 rounded-lg shadow-lg mb-8">
            <!-- Photo de profil -->
            <div class="flex-shrink-0 mb-4 md:mb-0">
                {% if repetiteur.avatar %}
                    <img class="w-32 h-32 rounded-full mx-auto md:mx-0" src="{{ repetiteur.avatar.url }}" alt="{{ repetiteur.user.first_name }}">
                {% else %}
                    <img class="w-32 h-32 rounded-full mx-auto md:mx-0" src="{% static 'images/default_avatar.webp' %}" alt="{{ repetiteur.user.first_name }}">
                {% endif %}
            </div>
            <!-- Informations principales -->
            <div class="ml-0 md:ml-6 text-center md:text-left">
                <h1 class="text-4xl font-bold text-gray-800">{{ repetiteur.user.first_name }} {{ repetiteur.user.last_name }}</h1>
                <p class="text-gray-600 mt-2"><i class="fas fa-map-marker-alt text-blue-500"></i> {{ repetiteur.user.adresse|default:"Adresse non spécifiée" }}</p>
                <div class="flex justify-center md:justify-start items-center space-x-2 mt-4">
                    <span class="bg-green-100 text-green-800 text-sm font-medium px-3 py-1 rounded-full">Disponible cette semaine</span>
                    <div class="flex items-center">
                        <span class="text-yellow-500">★★★★★</span>
                        <span class="text-gray-500 text-sm ml-2">({{ repetiteur.avis_count|default:"0" }} avis)</span>
                    </div>
                </div>
                <p class="text-gray-600 mt-4">A aidé plus de <span class="font-semibold">{{ repetiteur.etudiants_aides|default:"0" }}</span> élèves</p>
                <p class="text-gray-600">Prix par heure : <span class="font-semibold">{{ repetiteur.prix_par_heure|default:"Non spécifié" }} €</span></p>
            </div>
        </div>

        <!-- Navigation par onglets -->
        <div class="border-b border-gray-200 dark:border-gray-700">
            <ul class="flex flex-wrap -mb-px text-sm font-medium text-center text-gray-500 dark:text-gray-400">
            <li class="me-2">
                <a href="#a-propos" data-tab="a-propos" class="tab-link inline-flex items-center justify-center p-4 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 group active">
                <svg class="w-4 h-4 me-2 text-gray-400 group-hover:text-gray-500 dark:text-gray-500 dark:group-hover:text-gray-300" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M10 0a10 10 0 1 0 10 10A10.011 10.011 0 0 0 10 0Zm0 5a3 3 0 1 1 0 6 3 3 0 0 1 0-6Zm0 13a8.949 8.949 0 0 1-4.951-1.488A3.987 3.987 0 0 1 9 13h2a3.987 3.987 0 0 1 3.951 3.512A8.949 8.949 0 0 1 10 18Z"/>
                </svg>À propos
                </a>
            </li>
            <li class="me-2">
                <a href="#cv" data-tab="cv" class="tab-link inline-flex items-center justify-center p-4 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 group">
                <svg class="w-4 h-4 me-2 text-gray-400 group-hover:text-gray-500 dark:text-gray-500 dark:group-hover:text-gray-300" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M5 11.424V1a1 1 0 1 0-2 0v10.424a3.228 3.228 0 0 0 0 6.152V19a1 1 0 1 0 2 0v-1.424a3.228 3.228 0 0 0 0-6.152ZM19.25 14.5A3.243 3.243 0 0 0 17 11.424V1a1 1 0 0 0-2 0v10.424a3.227 3.227 0 0 0 0 6.152V19a1 1 0 1 0 2 0v-1.424a3.243 3.243 0 0 0 2.25-3.076Zm-6-9A3.243 3.243 0 0 0 11 2.424V1a1 1 0 0 0-2 0v1.424a3.228 3.228 0 0 0 0 6.152V19a1 1 0 1 0 2 0V8.576A3.243 3.243 0 0 0 13.25 5.5Z"/>
                </svg>CV
                </a>
            </li>
            <li class="me-2">
                <a href="#disponibilite" data-tab="disponibilite" class="tab-link inline-flex items-center justify-center p-4 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 group">
                <svg class="w-4 h-4 me-2 text-gray-400 group-hover:text-gray-500 dark:text-gray-500 dark:group-hover:text-gray-300" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M16 1h-3.278A1.992 1.992 0 0 0 11 0H7a1.993 1.993 0 0 0-1.722 1H2a2 2 0 0 0-2 2v15a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2Zm-3 14H5a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2Zm0-4H5a1 1 0 0 1 0-2h8a1 1 0 1 1 0 2Zm0-5H5a1 1 0 0 1 0-2h2V2h4v2h2a1 1 0 1 1 0 2Z"/>
                </svg>Disponibilité
                </a>
            </li>
            <li class="me-2">
                <a href="#avis" data-tab="avis" class="tab-link inline-flex items-center justify-center p-4 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 group">
                <svg class="w-4 h-4 me-2 text-gray-400 group-hover:text-gray-500 dark:text-gray-500 dark:group-hover:text-gray-300" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M10 0a10 10 0 1 0 10 10A10.011 10.011 0 0 0 10 0Zm0 5a3 3 0 1 1 0 6 3 3 0 0 1 0-6Zm0 13a8.949 8.949 0 0 1-4.951-1.488A3.987 3.987 0 0 1 9 13h2a3.987 3.987 0 0 1 3.951 3.512A8.949 8.949 0 0 1 10 18Z"/>
                </svg>Avis ({{ repetiteur.avis_count|default:"0" }})
                </a>
            </li>
            </ul>
        </div>

        <!-- Contenu des onglets -->
        <div class="tab-content">
            <!-- Onglet "À propos" -->
            <div id="a-propos" class="tab-panel active mb-12">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Qui suis-je ?</h2>
                <p class="text-gray-600 leading-relaxed">{{ repetiteur.biographie|default:"Aucune biographie disponible."|linebreaksbr }}</p>
                {% if repetiteur.description_detaillee %}
                    <h4 class="text-lg font-semibold text-gray-700 mt-6 mb-2">En lire plus</h4>
                    <p class="text-gray-600 leading-relaxed">{{ repetiteur.description_detaillee|linebreaksbr }}</p>
                {% endif %}
            </div>

            <!-- Onglet "CV" -->
            <div id="cv" class="tab-panel mb-12">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">CV. En savoir plus sur {{ repetiteur.user.first_name }}</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">Compétences :</h3>
                        <div class="flex flex-wrap gap-2">
                            {% for competence in repetiteur.competences.all %}
                                <span class="inline-block bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded">{{ competence }}</span>
                            {% empty %}
                                <span class="text-gray-500 text-sm">Non spécifié</span>
                            {% endfor %}
                        </div>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">Cours enseignés :</h3>
                        <div class="flex flex-wrap gap-2">
                            {% for cour in repetiteur.cours.all %}
                                <span class="inline-block bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded">{{ cour }}</span>
                            {% empty %}
                                <span class="text-gray-500 text-sm">Non spécifié</span>
                            {% endfor %}
                        </div>
                    </div>
                    <div>
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">Formations obtenues :</h3>
                        <div class="flex flex-wrap gap-2">
                            {% for formation in repetiteur.formations.all %}
                                <span class="inline-block bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded">{{ formation }}</span>
                            {% empty %}
                                <span class="text-gray-500 text-sm">Non spécifié</span>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Onglet "Disponibilité" -->
            <div id="disponibilite" class="tab-panel mb-12">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Disponibilité</h2>
                <p class="text-gray-600 leading-relaxed">{{ repetiteur.disponibilite|default:"Non spécifiée."|linebreaksbr }}</p>
            </div>

            <!-- Onglet "Avis" -->
            <div id="avis" class="tab-panel mb-12">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Avis ({{ repetiteur.avis_count|default:"0" }})</h2>
                {% for avis in repetiteur.avis %}
                    <div class="border-b py-4">
                        <p class="text-gray-800 font-semibold">{{ avis.auteur }}</p>
                        <div class="flex items-center mt-1">
                            <span class="text-yellow-500">★★★★★</span>
                            <span class="text-gray-500 text-sm ml-2">{{ avis.note }}/5</span>
                            <span class="text-gray-500 text-sm ml-4">{{ avis.date }}</span>
                        </div>
                        <p class="text-gray-600 mt-2">{{ avis.commentaire }}</p>
                    </div>
                {% empty %}
                    <p class="text-gray-600">Aucun avis pour le moment.</p>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Sidebar -->
    <aside class="fixed top-20 right-10 w-64 bg-white p-6 rounded-lg shadow-lg">
        {% if repetiteur.avatar %}
            <img class="w-24 h-24 rounded-full mx-auto mb-4" src="{{ repetiteur.avatar.url }}" alt="{{ repetiteur.user.first_name }}">
        {% else %}
            <img class="w-24 h-24 rounded-full mx-auto mb-4" src="{% static 'images/default_avatar.webp' %}" alt="{{ repetiteur.user.first_name }}">
        {% endif %}
        <button class="w-full bg-blue-700 text-white py-2 rounded-lg mt-4 hover:bg-blue-800">Réserver un cours d'essai</button>
        <p class="text-gray-600 text-center mt-2"><i class="fas fa-clock mr-1"></i> Durée : 30 minutes</p>
        <p class="text-gray-600 text-center mt-2"><i class="fas fa-chart-line mr-1"></i> Réservations la semaine dernière : {{ repetiteur.reservations_semaine|default:"0" }}</p>
        <p class="text-gray-600 text-center mt-2"><i class="fas fa-graduation-cap mr-1"></i> Expérience : {{ repetiteur.experience|default:"1" }} an(s)</p>
    </aside>
</section>
{% endblock %}

{% block extra_css %}
<style>
    .tab-panel {
        display: none;
    }
    .tab-panel.active {
        display: block;
    }
    .tab-link.active {
        border-bottom: 2px solid blue;
    }
</style>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const tabLinks = document.querySelectorAll('.tab-link');
        const tabPanels = document.querySelectorAll('.tab-panel');

        tabLinks.forEach(function(link) {
            link.addEventListener('click', function(event) {
                event.preventDefault();
                const tabId = this.getAttribute('data-tab');

                tabLinks.forEach(l => l.classList.remove('active'));
                tabPanels.forEach(p => p.classList.remove('active'));

                this.classList.add('active');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Set the first tab as active on load
        tabLinks[0].classList.add('active');
        tabPanels[0].classList.add('active');
    });
</script>
{% endblock %}